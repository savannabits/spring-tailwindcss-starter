"use strict";var e=require("through2"),t=require("plugin-error"),r=require("glob"),n=require("purgecss");function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=u(e),c=u(t),o=u(r),i=u(n);module.exports=function(e){return s.default.obj((async function(t,r,n){if(t.isNull())return n(null,t);if(t.isBuffer())try{const r={...e,content:(u=e.content,u.reduce(((e,t)=>[...e,...o.default.sync(t)]),[])),css:[{raw:t.contents.toString()}],stdin:!0},s=(await(new i.default).purge(r))[0],c=r.rejected&&s.rejected?s.rejected.join(" {}\n")+" {}":s.css;t.contents=Buffer.from(c,"utf-8"),n(null,t)}catch(e){this.emit("error",new c.default("gulp-purgecss",e.message))}var u;if(t.isStream()){const r=t;let u="";r.on("readable",(e=>{u+=e.read().toString()})).on("end",(async()=>{try{const s={...e,css:[u]},c=(await(new i.default).purge(s))[0],o=s.rejected&&c.rejected?c.rejected.join(" {}\n")+" {}":c.css;r.contents=Buffer.from(o,"utf-8"),n(null,t)}catch(e){this.emit("error",new c.default("gulp-purgecss",e.message))}}))}}))};
